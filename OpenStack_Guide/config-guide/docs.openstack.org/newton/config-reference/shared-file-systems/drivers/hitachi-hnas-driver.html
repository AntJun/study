<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
  
<!-- Mirrored from docs.openstack.org/newton/config-reference/shared-file-systems/drivers/hitachi-hnas-driver.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 01 Jan 2017 10:37:35 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
    <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"/>

    <title>OpenStack Docs: Hitachi NAS (HNAS) driver</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Bootstrap CSS -->
<link href="../../_static/css/bootstrap.min.css" rel="stylesheet">

<!-- Pygments CSS -->
<link href="../../_static/css/native.css" rel="stylesheet">

<!-- Fonts -->
<link href="../../../../../maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
<link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,700' rel='stylesheet' type='text/css'>

<!-- Custom CSS -->
<link href="../../_static/css/combined.css" rel="stylesheet">
<link href="../../_static/css/styles.css" rel="stylesheet">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
<link rel="stylesheet" href="../../_static/sphinxmark.css" type="text/css" />
  


<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','../../../../../www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-17511903-1', 'auto');
ga('send', 'pageview');
</script>
<!-- End Google Analytics -->

  </head>
  <body>
<nav class="navbar navbar-default inner" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button class="navbar-toggle" data-target="#bs-example-navbar-collapse-1" data-toggle="collapse" type="button">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <div class="brand-wrapper">
        <a class="navbar-brand" href="http://docs.openstack.org/"></a>
      </div>
      <div class="search-icon show"><i class="fa fa-search"></i> Search</div></div>
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <div class="search-container tiny">
        <div id="gcse">
          <script type="text/javascript">
(function() {
  var cx = '000108871792296872333:noj9nikm74i';
  var gcse = document.createElement('script');
  gcse.type = 'text/javascript';
  gcse.async = true;
  gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
      '//www.google.com/cse/cse.js?cx=' + cx;
  var s = document.getElementsByTagName('script')[0];
  s.parentNode.insertBefore(gcse, s);
})();
          </script>
          <gcse:search gname="standard"></gcse:search>
        </div>
        <i class="fa fa-times close-search"></i>
      </div>
      <ul class="nav navbar-nav navbar-main show">
        <li>
          <div id="gcse-mobile">
            <gcse:search gname="mobile"></gcse:search>
          </div>
        </li>
        <li>
          <a href="http://www.openstack.org/software/" class="drop" id="dropdownMenuSoftware">Software <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuSoftware">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/project-navigator/">Project Navigator</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/sample-configs/">Sample Configs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/start/">Get Started</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/roadmap/">Roadmap</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/latest-release/">Latest Release</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/sourcecode/">Source Code</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/user-stories/" class="drop" id="dropdownMenuUsers">Users <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuUsers">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/user-stories/">Overview</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/enterprise/">OpenStack in the Enterprise</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/appdev/">Application Developers</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://superuser.openstack.org/">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/surveys/landing">User Survey</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/community/" class="drop" id="dropdownMenuCommunity">Community <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuCommunity">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/">Welcome! Start Here</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/foundation/">OpenStack Foundation</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://wiki.openstack.org/">OpenStack Wiki</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://groups.openstack.org/">User Groups</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/speakers/">Speakers Bureau</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/foundation/companies/">Supporting Companies</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/jobs/">Jobs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/join/">Join The Community</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/marketplace/">Marketplace</a>
        </li>
        <li>
          <a href="http://www.openstack.org/events/" class="drop" id="dropdownMenuEvents">Events <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/events/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/summit/">The OpenStack Summit</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/events/">More OpenStack Events</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/events/#openstack_days">OpenStack Days</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/learn/" class="drop" id="dropdownMenuLearn">Learn <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu dropdown-hover" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/marketplace/training/">Training</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://superuser.openstack.org/">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://ask.openstack.org/">Ask a Technical Question</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/news/">News</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/blog/">Blog</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/videos/summits">Summit Videos</a></li>
          </ul>
        </li>
        <li>
          <a href="http://docs.openstack.org/">Docs</a>
        </li>
      </ul>
    </div>
  </div>
</nav>
    <div class="container docs-book-wrapper">
      <div class="row">
        <div class="col-lg-9 col-md-8 col-sm-8 col-lg-push-3 col-md-push-4 col-sm-push-4">
<div class="row">
  <div class="col-lg-8">
    <h2>Hitachi NAS (HNAS) driver</h2>
  </div>
  <div class="docs-actions">
    
    <a href="emc-unity-driver.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: EMC Unity driver"></i></a>
    
    
    <a href="hpe-3par-share-driver.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: HPE 3PAR driver"></i></a>
    
    <a id="logABugLink1" href="#" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
  </div>
</div>
          <div class="row docs-byline">
            <div class="docs-updated">updated: 2016-12-31 09:03</div>
          </div>
          <div class="row">
            <div class="col-lg-12">
              <div class="docs-top-contents">

<h5><a href="../../index-2.html">Contents</a></h5>
<ul>
<li><a class="reference internal" href="#">Hitachi NAS (HNAS) driver</a><ul>
<li><a class="reference internal" href="#requirements">Requirements</a></li>
<li><a class="reference internal" href="#supported-shared-filesystems-and-operations">Supported shared filesystems and operations</a></li>
<li><a class="reference internal" href="#driver-options">Driver options</a></li>
<li><a class="reference internal" href="#pre-configuration-on-openstack-deployment">Pre-configuration on OpenStack deployment</a></li>
<li><a class="reference internal" href="#pre-configuration-on-hnas">Pre-configuration on HNAS</a></li>
<li><a class="reference internal" href="#back-end-configuration">Back end configuration</a></li>
<li><a class="reference internal" href="#manage-and-unmanage-shares">Manage and unmanage shares</a></li>
<li><a class="reference internal" href="#additional-notes">Additional notes</a></li>
</ul>
</li>
</ul>

              </div>
              <div class="docs-body">

  <div class="section" id="hitachi-nas-hnas-driver">
<h1>Hitachi NAS (HNAS) driver<a class="headerlink" href="#hitachi-nas-hnas-driver" title="Permalink to this headline">¶</a></h1>
<p>The HNAS driver provides NFS Shared File Systems to OpenStack.</p>
<div class="section" id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Hitachi NAS Platform Models 3080, 3090, 4040, 4060, 4080, and 4100.</li>
<li>HNAS/SMU software version is 12.2 or higher.</li>
<li>HNAS configuration and management utilities to create a storage pool (span)
and an EVS.<ul>
<li>GUI (SMU).</li>
<li>SSC CLI.</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="supported-shared-filesystems-and-operations">
<h2>Supported shared filesystems and operations<a class="headerlink" href="#supported-shared-filesystems-and-operations" title="Permalink to this headline">¶</a></h2>
<p>The driver supports NFS shares.</p>
<p>The following operations are supported:</p>
<ul class="simple">
<li>Create a share.</li>
<li>Delete a share.</li>
<li>Allow share access.</li>
<li>Deny share access.</li>
<li>Create a snapshot.</li>
<li>Delete a snapshot.</li>
<li>Create a share from a snapshot.</li>
<li>Extend a share.</li>
<li>Manage a share.</li>
<li>Unmanage a share.</li>
<li>Shrink a share.</li>
</ul>
</div>
<div class="section" id="driver-options">
<h2>Driver options<a class="headerlink" href="#driver-options" title="Permalink to this headline">¶</a></h2>
<p>This table contains the configuration options specific to the share driver.</p>
<table border="1" class="config-ref-table docutils" id="id1">
<span id="manila-hds-hnas"></span><caption><span class="caption-text">Description of HDS NAS Share Driver configuration options</span><a class="headerlink" href="#id1" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Configuration option = Default value</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>[DEFAULT]</strong></td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">hitachi_hnas_allow_cifs_snapshot_while_mounted</span></code> = <code class="docutils literal"><span class="pre">False</span></code></td>
<td>(Boolean) By default, CIFS snapshots are not allowed to be taken when the share has clients connected because consistent point-in-time replica cannot be guaranteed for all files. Enabling this might cause inconsistent snapshots on CIFS shares.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">hitachi_hnas_cluster_admin_ip0</span></code> = <code class="docutils literal"><span class="pre">None</span></code></td>
<td>(String) The IP of the clusters admin node. Only set in HNAS multinode clusters.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">hitachi_hnas_driver_helper</span></code> = <code class="docutils literal"><span class="pre">manila.share.drivers.hitachi.hnas.ssh.HNASSSHBackend</span></code></td>
<td>(String) Python class to be used for driver helper.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">hitachi_hnas_evs_id</span></code> = <code class="docutils literal"><span class="pre">None</span></code></td>
<td>(Integer) Specify which EVS this backend is assigned to.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">hitachi_hnas_evs_ip</span></code> = <code class="docutils literal"><span class="pre">None</span></code></td>
<td>(String) Specify IP for mounting shares.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">hitachi_hnas_file_system_name</span></code> = <code class="docutils literal"><span class="pre">None</span></code></td>
<td>(String) Specify file-system name for creating shares.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">hitachi_hnas_ip</span></code> = <code class="docutils literal"><span class="pre">None</span></code></td>
<td>(String) HNAS management interface IP for communication between Manila controller and HNAS.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">hitachi_hnas_password</span></code> = <code class="docutils literal"><span class="pre">None</span></code></td>
<td>(String) HNAS user password. Required only if private key is not provided.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">hitachi_hnas_ssh_private_key</span></code> = <code class="docutils literal"><span class="pre">None</span></code></td>
<td>(String) RSA/DSA private key value used to connect into HNAS. Required only if password is not provided.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">hitachi_hnas_stalled_job_timeout</span></code> = <code class="docutils literal"><span class="pre">30</span></code></td>
<td>(Integer) The time (in seconds) to wait for stalled HNAS jobs before aborting.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">hitachi_hnas_user</span></code> = <code class="docutils literal"><span class="pre">None</span></code></td>
<td>(String) HNAS username Base64 String in order to perform tasks such as create file-systems and network interfaces.</td>
</tr>
<tr class="row-even"><td><strong>[hnas1]</strong></td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">share_backend_name</span></code> = <code class="docutils literal"><span class="pre">None</span></code></td>
<td>(String) The backend name for a given driver implementation.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">share_driver</span></code> = <code class="docutils literal"><span class="pre">manila.share.drivers.generic.GenericShareDriver</span></code></td>
<td>(String) Driver to use for share creation.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="pre-configuration-on-openstack-deployment">
<h2>Pre-configuration on OpenStack deployment<a class="headerlink" href="#pre-configuration-on-openstack-deployment" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p class="first">Install the OpenStack environment with manila. See the
<a class="reference external" href="http://docs.openstack.org/">OpenStack installation guide</a>.</p>
</li>
<li><p class="first">Configure the OpenStack networking so it can reach HNAS Management
interface and HNAS EVS Data interface.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In the driver mode used by HNAS Driver (DHSS = <code class="docutils literal"><span class="pre">False</span></code>), the driver
does not handle network configuration, it is up to the administrator to
configure it.</p>
</div>
<ul>
<li><p class="first">Configure the network of the manila-share node network to reach HNAS
management interface through the admin network.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The manila-share node only requires the HNAS EVS data interface if you
plan to use share migration.</p>
</div>
</li>
<li><p class="first">Configure the network of the Compute and Networking nodes to reach HNAS
EVS data interface through the data network.</p>
</li>
<li><p class="first">Example of networking architecture:</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../../_images/hds_network.jpg"><img alt="Example networking scenario" src="../../_images/hds_network.jpg" style="width: 60%;" /></a>
</div>
</li>
<li><p class="first">Edit the <code class="docutils literal"><span class="pre">/etc/neutron/plugins/ml2/ml2_conf.ini</span></code> file and update the
following settings in their respective tags. In case you use linuxbridge,
update bridge mappings at linuxbridge section:</p>
</li>
</ul>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">It is mandatory that HNAS management interface is reachable from the
Shared File System node through the admin network, while the selected
EVS data interface is reachable from OpenStack Cloud, such as through
Neutron flat networking.</p>
</div>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[ml2]</span>
<span class="na">type_drivers</span> <span class="o">=</span> <span class="s">flat,vlan,vxlan,gre</span>
<span class="na">mechanism_drivers</span> <span class="o">=</span> <span class="s">openvswitch</span>
<span class="k">[ml2_type_flat]</span>
<span class="na">flat_networks</span> <span class="o">=</span> <span class="s">physnet1,physnet2</span>
<span class="k">[ml2_type_vlan]</span>
<span class="na">network_vlan_ranges</span> <span class="o">=</span> <span class="s">physnet1:1000:1500,physnet2:2000:2500</span>
<span class="k">[ovs]</span>
<span class="na">bridge_mappings</span> <span class="o">=</span> <span class="s">physnet1:br-ex,physnet2:br-eth1</span>
</pre></div>
</div>
<p>You may have to repeat the last line above in another file on the Compute
node, if it exists it is located in:
<code class="docutils literal"><span class="pre">/etc/neutron/plugins/openvswitch/ovs_neutron_plugin.ini</span></code>.</p>
<ul>
<li><p class="first">In case openvswitch for neutron agent, run in network node:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> ifconfig eth1 0
<span class="gp">#</span> ovs-vsctl add-br br-eth1
<span class="gp">#</span> ovs-vsctl add-port br-eth1 eth1
<span class="gp">#</span> ifconfig eth1 up
</pre></div>
</div>
</li>
<li><p class="first">Restart all neutron processes.</p>
</li>
</ul>
</li>
<li><p class="first">Create the data HNAS network in OpenStack:</p>
<ul>
<li><p class="first">List the available projects:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack project list
</pre></div>
</div>
</li>
<li><p class="first">Create a network to the given project (DEMO), providing the project name,
a name for the network, the name of the physical network over which the
virtual network is implemented, and the type of the physical mechanism by
which the virtual network is implemented:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack network create --project DEMO --provider-network-type flat <span class="se">\</span>
<span class="go">  --provider-physical-network physnet2 hnas_network</span>
</pre></div>
</div>
</li>
<li><p class="first">Optional - List available networks:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack network list
</pre></div>
</div>
</li>
<li><p class="first">Create a subnet to the same porject (DEMO), the gateway IP of this subnet,
a name for the subnet, the network name created before, and the CIDR of
subnet:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack subnet create --project DEMO --gateway GATEWAY <span class="se">\</span>
<span class="go">  --subnet-range SUBNET_CIDR --network NETWORK HNAS_SUBNET</span>
</pre></div>
</div>
</li>
<li><p class="first">OPTIONAL - List available subnets:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack subnet list
</pre></div>
</div>
</li>
<li><p class="first">Add the subnet interface to a router, providing the router name and
subnet name created before:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack router add subnet SUBNET ROUTER
</pre></div>
</div>
</li>
</ul>
</li>
</ol>
</div>
<div class="section" id="pre-configuration-on-hnas">
<h2>Pre-configuration on HNAS<a class="headerlink" href="#pre-configuration-on-hnas" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p class="first">Create a file system on HNAS. See the <a class="reference external" href="http://www.hds.com/assets/pdf/hus-file-module-file-services-administration-guide.pdf">Hitachi HNAS reference</a>.</p>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">Make sure that the filesystem is not created as a replication target.
Refer official HNAS administration guide.</p>
</div>
</li>
<li><p class="first">Prepare the HNAS EVS network.</p>
<ul>
<li><p class="first">Create a route in HNAS to the project network:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> console-context --evs &lt;EVS_ID_IN_USE&gt; route-net-add --gateway &lt;FLAT_NETWORK_GATEWAY&gt; <span class="se">\</span>
<span class="go">&lt;TENANT_PRIVATE_NETWORK&gt;</span>
</pre></div>
</div>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">Make sure multi-tenancy is enabled and routes are configured
per EVS.</p>
</div>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> console-context --evs <span class="m">3</span> route-net-add --gateway 192.168.1.1 <span class="se">\</span>
<span class="go">10.0.0.0/24</span>
</pre></div>
</div>
</li>
</ul>
</li>
</ol>
</div>
<div class="section" id="back-end-configuration">
<h2>Back end configuration<a class="headerlink" href="#back-end-configuration" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p class="first">Configure HNAS driver.</p>
<ul>
<li><p class="first">Configure HNAS driver according to your environment. This example shows
a minimal HNAS driver configuration:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[DEFAULT]</span>
<span class="na">enabled_share_backends</span> <span class="o">=</span> <span class="s">hnas1</span>
<span class="na">enabled_share_protocols</span> <span class="o">=</span> <span class="s">NFS</span>
<span class="k">[hnas1]</span>
<span class="na">share_backend_name</span> <span class="o">=</span> <span class="s">HNAS1</span>
<span class="na">share_driver</span> <span class="o">=</span> <span class="s">manila.share.drivers.hitachi.hds_hnas.HDSHNASDriver</span>
<span class="na">driver_handles_share_servers</span> <span class="o">=</span> <span class="s">False</span>
<span class="na">hds_hnas_ip</span> <span class="o">=</span> <span class="s">172.24.44.15</span>
<span class="na">hds_hnas_user</span> <span class="o">=</span> <span class="s">supervisor</span>
<span class="na">hds_hnas_password</span> <span class="o">=</span> <span class="s">supervisor</span>
<span class="na">hds_hnas_evs_id</span> <span class="o">=</span> <span class="s">1</span>
<span class="na">hds_hnas_evs_ip</span> <span class="o">=</span> <span class="s">10.0.1.20</span>
<span class="na">hds_hnas_file_system_name</span> <span class="o">=</span> <span class="s">FS-Manila</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p class="first">Optional - HNAS multi-backend configuration.</p>
<ul>
<li><p class="first">Update the <code class="docutils literal"><span class="pre">enabled_share_backends</span></code> flag with the names of the back
ends separated by commas.</p>
</li>
<li><p class="first">Add a section for every back end according to the example bellow:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[DEFAULT]</span>
<span class="na">enabled_share_backends</span> <span class="o">=</span> <span class="s">hnas1,hnas2</span>
<span class="na">enabled_share_protocols</span> <span class="o">=</span> <span class="s">NFS</span>
<span class="k">[hnas1]</span>
<span class="na">share_backend_name</span> <span class="o">=</span> <span class="s">HNAS1</span>
<span class="na">share_driver</span> <span class="o">=</span> <span class="s">manila.share.drivers.hitachi.hds_hnas.HDSHNASDriver</span>
<span class="na">driver_handles_share_servers</span> <span class="o">=</span> <span class="s">False</span>
<span class="na">hds_hnas_ip</span> <span class="o">=</span> <span class="s">172.24.44.15</span>
<span class="na">hds_hnas_user</span> <span class="o">=</span> <span class="s">supervisor</span>
<span class="na">hds_hnas_password</span> <span class="o">=</span> <span class="s">supervisor</span>
<span class="na">hds_hnas_evs_id</span> <span class="o">=</span> <span class="s">1</span>
<span class="na">hds_hnas_evs_ip</span> <span class="o">=</span> <span class="s">10.0.1.20</span>
<span class="na">hds_hnas_file_system_name</span> <span class="o">=</span> <span class="s">FS-Manila1</span>
<span class="k">[hnas2]</span>
<span class="na">share_backend_name</span> <span class="o">=</span> <span class="s">HNAS2</span>
<span class="na">share_driver</span> <span class="o">=</span> <span class="s">manila.share.drivers.hitachi.hds_hnas.HDSHNASDriver</span>
<span class="na">driver_handles_share_servers</span> <span class="o">=</span> <span class="s">False</span>
<span class="na">hds_hnas_ip</span> <span class="o">=</span> <span class="s">172.24.44.15</span>
<span class="na">hds_hnas_user</span> <span class="o">=</span> <span class="s">supervisor</span>
<span class="na">hds_hnas_password</span> <span class="o">=</span> <span class="s">supervisor</span>
<span class="na">hds_hnas_evs_id</span> <span class="o">=</span> <span class="s">1</span>
<span class="na">hds_hnas_evs_ip</span> <span class="o">=</span> <span class="s">10.0.1.20</span>
<span class="na">hds_hnas_file_system_name</span> <span class="o">=</span> <span class="s">FS-Manila2</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p class="first">Disable DHSS for HNAS share type configuration:</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Shared File Systems requires that the share type includes the
<code class="docutils literal"><span class="pre">driver_handles_share_servers</span></code> extra-spec. This ensures that the share
will be created on a backend that supports the requested
<code class="docutils literal"><span class="pre">driver_handles_share_servers</span></code> capability.</p>
</div>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> manila type-create hitachi False
</pre></div>
</div>
</li>
<li><p class="first">(Optional multiple back end) Create an extra-spec for specifying which
HNAS back end will be created by the share:</p>
<ul>
<li><p class="first">Create additional share types.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> manila type-create hitachi2 False
</pre></div>
</div>
</li>
<li><p class="first">Add an extra-spec for each share-type in order to match a specific back
end. Therefore, it is possible to specify which back end the Shared File
System service will use when creating a share.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> manila type-key hitachi <span class="nb">set</span> <span class="nv">share_backend_name</span><span class="o">=</span>hnas1
<span class="gp">$</span> manila type-key hitachi2 <span class="nb">set</span> <span class="nv">share_backend_name</span><span class="o">=</span>hnas2
</pre></div>
</div>
</li>
</ul>
</li>
<li><p class="first">Restart all Shared File Systems services (<code class="docutils literal"><span class="pre">manila-share</span></code>,
<code class="docutils literal"><span class="pre">manila-scheduler</span></code> and <code class="docutils literal"><span class="pre">manila-api</span></code>).</p>
</li>
</ol>
</div>
<div class="section" id="manage-and-unmanage-shares">
<h2>Manage and unmanage shares<a class="headerlink" href="#manage-and-unmanage-shares" title="Permalink to this headline">¶</a></h2>
<p>Shared File Systems has the ability to manage and unmanage shares. If there is
a share in the storage and it is not in OpenStack, you can manage that share
and use it as a Shared File Systems share. HNAS drivers use virtual-volumes
(V-VOL) to create shares. Only V-VOL shares can be used by the driver. If the
NFS export is an ordinary FS export, it is not possible to use it in Shared
File Systems. The unmanage operation only unlinks the share from Shared File
Systems. All data is preserved.</p>
</div>
<div class="section" id="additional-notes">
<h2>Additional notes<a class="headerlink" href="#additional-notes" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>HNAS has some restrictions about the number of EVSs, filesystems,
virtual-volumes, and simultaneous SSC connections. Check the manual
specification for your system.</li>
<li>Shares and snapshots are thin provisioned. It is reported to Shared File
System only the real used space in HNAS. Also, a snapshot does not initially
take any space in HNAS, it only stores the difference between the share and
the snapshot, so it grows when share data is changed.</li>
<li>Administrators should manage the project&#8217;s quota
(<strong class="command">manila quota-update</strong>) to control the back-end usage.</li>
</ul>
</div>
</div>


              </div>
            </div>
          </div>
          <div class="docs-actions">
          
            <a href="emc-unity-driver.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: EMC Unity driver"></i></a>
          
          
            <a href="hpe-3par-share-driver.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: HPE 3PAR driver"></i></a>
          
            <a id="logABugLink3" href="#" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
          </div>
          <div class="row docs-byline bottom">
            <div class="docs-updated">updated: 2016-12-31 09:03</div>
          </div>
          <div class="row">
            <div class="col-lg-8 col-md-8 col-sm-8 docs-license">
<a href="https://creativecommons.org/licenses/by/3.0/">
 <img src="../../_static/images/docs/license.png" alt="Creative Commons Attribution 3.0 License"/>
</a>
<p>
 Except where otherwise noted, this document is licensed under
 <a href="https://creativecommons.org/licenses/by/3.0/">Creative Commons
 Attribution 3.0 License</a>. See all <a href="http://www.openstack.org/legal">
 OpenStack Legal Documents</a>.
</p>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-4 docs-actions-wrapper">
            <!-- ID buglinkbottom added so that pre-filled doc bugs
                 are sent to Launchpad projects related to the document -->
              <a href="#" id="logABugLink2" class="docs-footer-actions"><i class="fa fa-bug"></i> found an error? report a bug</a>
              <a href="http://ask.openstack.org/" class="docs-footer-actions"><i class="fa fa-question-circle"></i> questions?</a>
            </div>
          </div>
        </div>
<div class="col-lg-3 col-md-4 col-sm-4 col-lg-pull-9 col-md-pull-8 col-sm-pull-8 docs-sidebar">
  <div class="search-icon show">
    <i class="fa fa-search"></i> Search
  </div>
  <div class="btn-group docs-sidebar-releases">
    <button onclick="location.href='http://docs.openstack.org/'" class="btn docs-sidebar-home" data-toggle="tooltip" data-placement="top" title="Docs Home"><i class="fa fa-arrow-circle-o-left"></i></button>
<button href="#" type="button" data-toggle="dropdown" class="btn docs-sidebar-release-select">OpenStack Documentation<i class="fa fa-caret-down"></i></button>
    <ul class="dropdown-menu docs-sidebar-dropdown" role="menu" aria-labelledby="dLabel">
      <li role="presentation" class="dropdown-header">Guides</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#install-guides">Install Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#user-guides">User Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#configuration-guides">Configuration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#ops-and-admin-guides">Operations and Administration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#api-guides">API Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#contributor-guides">Contributor Guides</a></li>
      <li role="presentation" class="dropdown-header">Languages</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/ja/">日本語 (Japanese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/de/">Deutsch (German)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/fr/">Français (French)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/pt_BR/">Português (Portuguese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/zh_CN/">简体中文 (Simplified Chinese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/ko_KR/">한국어 (Korean)</a></li>
    </ul>
  </div>
  <div class="docs-sidebar-toc">
    <div class="docs-sidebar-section" id="table-of-contents">
      <a href="../../index-2.html" class="docs-sidebar-section-title"><h4>Contents</h4></a>
      <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../config-overview.html">OpenStack configuration overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../common-configurations.html">Common configurations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../application-catalog.html">Application Catalog service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../bare-metal.html">Bare Metal service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../block-storage.html">Block Storage service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../clustering.html">Clustering service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../compute.html">Compute service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dashboard.html">Dashboard</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data-processing.html">Data Processing service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../database.html">Database service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../identity.html">Identity service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../image.html">Image service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../message.html">Message service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../networking.html">Networking service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../object-storage.html">Object Storage service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../orchestration.html">Orchestration service</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../shared-file-systems.html">Shared File Systems service</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../overview.html">Introduction to the Shared File Systems service</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html">Shared File Systems API configuration</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../drivers.html">Share drivers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../log-files.html">Log files used by Shared File Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../config-options.html">Additional options</a></li>
<li class="toctree-l2"><a class="reference internal" href="../samples/index.html">Shared File Systems service sample configuration files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tables/conf-changes/manila.html">New, updated, and deprecated options in Newton for Shared File Systems service</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../telemetry.html">Telemetry service</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../policy-json-file.html">The policy.json file</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../firewalls-default-ports.html">Firewalls and default ports</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../common/app-support.html">Community support</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../common/glossary.html">Glossary</a></li>
</ul>

    </div>
  </div>
</div>
      </div>
    </div>
<footer>
  <div class="container">
    <div class="row footer-links">
      <div class="col-lg-2 col-sm-2">
        <h3>OpenStack</h3>
        <ul>
          <li><a href="http://openstack.org/projects/">Projects</a></li>
          <li><a href="http://openstack.org/projects/openstack-security/">OpenStack Security</a></li>
          <li><a href="http://openstack.org/projects/openstack-faq/">Common Questions</a></li>
          <li><a href="http://openstack.org/blog/">Blog</a></li>
          <li><a href="http://openstack.org/news/">News</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Community</h3>
        <ul>
          <li><a href="http://openstack.org/community/">User Groups</a></li>
          <li><a href="http://openstack.org/community/events/">Events</a></li>
          <li><a href="http://openstack.org/community/jobs/">Jobs</a></li>
          <li><a href="http://openstack.org/foundation/companies/">Companies</a></li>
          <li><a href="http://docs.openstack.org/infra/manual/developers.html">Contribute</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Documentation</h3>
        <ul>
          <li><a href="http://docs.openstack.org/">OpenStack Manuals</a></li>
          <li><a href="http://openstack.org/software/start/">Getting Started</a></li>
          <li><a href="http://developer.openstack.org/">API Documentation</a></li>
          <li><a href="https://wiki.openstack.org/">Wiki</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Branding & Legal</h3>
        <ul>
          <li><a href="http://openstack.org/brand/">Logos & Guidelines</a></li>
          <li><a href="http://openstack.org/brand/openstack-trademark-policy/">Trademark Policy</a></li>
          <li><a href="http://openstack.org/privacy/">Privacy Policy</a></li>
          <li><a href="https://wiki.openstack.org/wiki/How_To_Contribute#Contributor_License_Agreement">OpenStack CLA</a></li>
        </ul>
      </div>
      <div class="col-lg-4 col-sm-4">
        <h3>Stay In Touch</h3>
        <a href="https://twitter.com/OpenStack" target="_blank" class="social-icons footer-twitter"></a>
        <a href="https://www.facebook.com/openstack" target="_blank" class="social-icons footer-facebook"></a>
        <a href="https://www.linkedin.com/company/openstack" target="_blank" class="social-icons footer-linkedin"></a>
        <a href="https://www.youtube.com/user/OpenStackFoundation" target="_blank" class="social-icons footer-youtube"></a>
        <p class="fine-print">
          The OpenStack project is provided under the
          <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 license</a>. Openstack.org is powered by
          <a href="http://rackspace.com/" target="_blank">Rackspace Cloud Computing</a>.
        </p>
      </div>
    </div>
  </div>
</footer>
<!-- jQuery -->
<script type="text/javascript" src="../../_static/js/jquery-1.11.3.js"></script>

<!-- Bootstrap JavaScript -->
<script type="text/javascript" src="../../_static/js/bootstrap.min.js"></script>

<!-- The rest of the JS -->
<script type="text/javascript" src="../../_static/js/navigation.js"></script>

<!-- Docs JS -->
<script type="text/javascript" src="../../_static/js/docs.js"></script>

<!-- Popovers -->
<script type="text/javascript" src="../../_static/js/webui-popover.js"></script>

<!-- Javascript for page -->
<script language="JavaScript">
/* build a description of this page including SHA, source location on git repo,
   build time and the project's launchpad bug tag. Set the HREF of the bug
   buttons */

    var lineFeed = "%0A";
    var gitURL = "Source: Can't derive source file URL";

    /* there have been cases where "pagename" wasn't set; better check for it */
        /* The URL of the source file on Git is based on the giturl variable
           in conf.py, which must be manually initialized to the source file
           URL in Git.
           "pagename" is a standard sphinx parameter containing the name of
           the source file, without extension.                             */

        var sourceFile = "shared-file-systems/drivers/hitachi-hnas-driver" + ".rst";
        gitURL = "Source: http://git.openstack.org/cgit/openstack/openstack-manuals/tree/doc/config-reference/source" + "/" + sourceFile;

    /* gitsha, project and bug_tag rely on variables in conf.py */
    var gitSha = "SHA: 8769323640f01e3e92c0a6af672b0e6fab8a4af7";
        var bugProject = "openstack-manuals";
        var bugTitle = "Hitachi NAS (HNAS) driver in Configuration Reference";
    var fieldTags = "config-reference";

    /* "last_updated" is the build date and time. It relies on the
       conf.py variable "html_last_updated_fmt", which should include
       year/month/day as well as hours and minutes                   */
    var buildstring = "Release: 0.9 on 2016-12-31 09:03";

    var fieldComment = encodeURI(buildstring) +
                       lineFeed + encodeURI(gitSha) +
                       lineFeed + encodeURI(gitURL) ;

    logABug(bugTitle, bugProject, fieldComment, fieldTags);
</script>

<!-- Javascript for search boxes (both sidebar and top nav) -->
<script type="text/javascript">
(function() {
var cx = '000108871792296872333:noj9nikm74i';
var gcse = document.createElement('script');
gcse.type = 'text/javascript';
gcse.async = true;
gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
'//www.google.com/cse/cse.js?cx=' + cx;
var s = document.getElementsByTagName('script')[0];
s.parentNode.insertBefore(gcse, s);
})();
</script>

  </body>

<!-- Mirrored from docs.openstack.org/newton/config-reference/shared-file-systems/drivers/hitachi-hnas-driver.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 01 Jan 2017 10:37:38 GMT -->
</html>